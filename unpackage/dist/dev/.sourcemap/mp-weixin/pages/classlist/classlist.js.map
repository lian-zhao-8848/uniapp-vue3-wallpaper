{"version":3,"file":"classlist.js","sources":["pages/classlist/classlist.vue","D:/text/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xhc3NsaXN0L2NsYXNzbGlzdC52dWU"],"sourcesContent":["<template>\n\t<view class=\"classList\">\n\t\t<view class=\"content\">\n\t\t\t<template v-if=\"loading\">\n\t\t\t\t<view class=\"item\" v-for=\"item in 12\" :key=\"item\">\n\t\t\t\t\t<uv-skeletons :loading=\"loading\" :skeleton=\"skeleton\"></uv-skeletons>\n\t\t\t\t</view>\n\t\t\t</template>\n\n\t\t\t<template v-else>\n\t\t\t\t<navigator :url=\"`/pages/preview/preview?id=${item._id}`\" class=\"item\" v-for=\"item in classList\" :key=\"item._id\">\n\t\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\"></image>\n\t\t\t\t</navigator>\n\t\t\t</template>\n\t\t</view>\n\t\t<view class=\"load-more-box\" v-if=\"!loading\"><uni-load-more :status=\"loadStatus\" color=\"#007AFF\" :contentText=\"customText\" /></view>\n\t</view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { onLoad, onUnload, onReachBottom, onShareAppMessage, onShareTimeline } from '@dcloudio/uni-app';\nimport { gotoHome } from '@/utils/common.js';\nimport { apiGetclassList, apiGetHistoryList } from '@/api/apis.js';\nconst classList = ref([]);\nconst noData = ref(false);\n\n//修改文字状态\nconst customText = ref({\n\tcontentrefresh: '冲锋======================',\n\tcontentnomore: '已经被榨干了TT'\n});\n//定义loading状态\nconst loading = ref(true);\n//触底加载状态\nconst loadStatus = ref('more');\nconst skeleton = ref([\n\t{\n\t\ttype: 'line',\n\t\tnum: 1, // 因为外层已经循环了 12 个 item，所以这里每个 item 只需要 1 个占位块\n\t\tstyle: {\n\t\t\twidth: '100%',\n\t\t\theight: '440rpx', // 【核心】高度必须和下方 CSS 中 .item 的高度一致，防止切换时页面抖动\n\t\t\tborderRadius: '8rpx' // 可选：加一点圆角让骨架屏更好看\n\t\t}\n\t}\n]);\nconst queryParams = {\n\tpageNum: 1,\n\tpageSize: 12\n};\n//注意生命周期，加载顺序问题\n//修改导航标题\nlet pageName;\nonLoad((e) => {\n\tlet { id = null, name = null, type = null } = e;\n\t// if (!id) gotoHome();\n\tif (type) queryParams.type = type;\n\tif (id) queryParams.classid = id;\n\tpageName = name;\n\tuni.setNavigationBarTitle({\n\t\ttitle: pageName\n\t});\n\t//这里执行才是正确数据\n\tgetClassList();\n});\n//触底加载更多\nonReachBottom(() => {\n\tif (noData.value) return;\n\tif (loadStatus.value === 'loading') return;\n\tqueryParams.pageNum++;\n\tgetClassList();\n});\n//获取分类列表的网络数据\nconst getClassList = async () => {\n\tif (!loading.value) {\n\t\tloadStatus.value = 'loading';\n\t}\n\ttry {\n\t\tlet res;\n\t\tif (queryParams.classid) res = await apiGetclassList(queryParams);\n\t\tif (queryParams.type) res = await apiGetHistoryList(queryParams);\n\n\t\tclassList.value = [...classList.value, ...res.data];\n\t\tuni.setStorageSync('storageClassList', classList.value);\n\t\tif (queryParams.pageSize > res.data.length) {\n\t\t\tnoData.value = true;\n\t\t\tloadStatus.value = 'no-more';\n\t\t} else {\n\t\t\tloadStatus.value = 'more';\n\t\t}\n\t} finally {\n\t\t//关闭骨架屏效果\n\t\tloading.value = false;\n\t}\n};\n\n//分享给好友\nonShareAppMessage((e) => {\n\treturn {\n\t\ttitle: '翔翔壁纸',\n\t\tpath: `/pages/classlist/classlist?id=${queryParams.classid}&name=${pageName}`\n\t};\n});\n\n//分享到朋友圈\nonShareTimeline(() => {\n\treturn {\n\t\ttitle: '翔翔壁纸'\n\t};\n});\n\n//离开页面清除缓存\nonUnload(() => {\n\tuni.removeStorageSync('storageClassList');\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.classList {\n\t.content {\n\t\tdisplay: grid;\n\t\tgap: 5rpx;\n\t\tgrid-template-columns: repeat(3, 1fr);\n\t\tpadding: 5rpx;\n\t\t.item {\n\t\t\theight: 440rpx;\n\t\t\timage {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\t\t}\n\t}\n\t.load-more-box {\n\t\tpadding-top: 30rpx;\n\t\tpadding-bottom: 50rpx;\n\t}\n}\n</style>\n","import MiniProgramPage from 'C:/Users/mlz/Desktop/wallpaper-kt/pages/classlist/classlist.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","onReachBottom","apiGetclassList","apiGetHistoryList","onShareAppMessage","onShareTimeline","onUnload"],"mappings":";;;;;;;;;;;;;;;;AAwBA,UAAA,YAAAA,cAAAA,IAAA,CAAA,CAAA;AACA,UAAA,SAAAA,cAAAA,IAAA,KAAA;AAGA,UAAA,aAAAA,cAAAA,IAAA;AAAA,MACA,gBAAA;AAAA,MACA,eAAA;AAAA,IACA,CAAA;AAEA,UAAA,UAAAA,cAAAA,IAAA,IAAA;AAEA,UAAA,aAAAA,cAAAA,IAAA,MAAA;AACA,UAAA,WAAAA,cAAAA,IAAA;AAAA,MACA;AAAA,QACA,MAAA;AAAA,QACA,KAAA;AAAA;AAAA,QACA,OAAA;AAAA,UACA,OAAA;AAAA,UACA,QAAA;AAAA;AAAA,UACA,cAAA;AAAA;AAAA,QACA;AAAA,MACA;AAAA,IACA,CAAA;AACA,UAAA,cAAA;AAAA,MACA,SAAA;AAAA,MACA,UAAA;AAAA,IACA;AAGA,QAAA;AACAC,kBAAA,OAAA,CAAA,MAAA;AACA,UAAA,EAAA,KAAA,MAAA,OAAA,MAAA,OAAA,KAAA,IAAA;AAEA,UAAA;AAAA,oBAAA,OAAA;AACA,UAAA;AAAA,oBAAA,UAAA;AACA,iBAAA;AACAC,oBAAAA,MAAA,sBAAA;AAAA,QACA,OAAA;AAAA,MACA,CAAA;AAEA;IACA,CAAA;AAEAC,kBAAAA,cAAA,MAAA;AACA,UAAA,OAAA;AAAA;AACA,UAAA,WAAA,UAAA;AAAA;AACA,kBAAA;AACA;IACA,CAAA;AAEA,UAAA,eAAA,YAAA;AACA,UAAA,CAAA,QAAA,OAAA;AACA,mBAAA,QAAA;AAAA,MACA;AACA,UAAA;AACA,YAAA;AACA,YAAA,YAAA;AAAA,gBAAA,MAAAC,SAAA,gBAAA,WAAA;AACA,YAAA,YAAA;AAAA,gBAAA,MAAAC,SAAA,kBAAA,WAAA;AAEA,kBAAA,QAAA,CAAA,GAAA,UAAA,OAAA,GAAA,IAAA,IAAA;AACAH,sBAAAA,MAAA,eAAA,oBAAA,UAAA,KAAA;AACA,YAAA,YAAA,WAAA,IAAA,KAAA,QAAA;AACA,iBAAA,QAAA;AACA,qBAAA,QAAA;AAAA,QACA,OAAA;AACA,qBAAA,QAAA;AAAA,QACA;AAAA,MACA,UAAA;AAEA,gBAAA,QAAA;AAAA,MACA;AAAA,IACA;AAGAI,kBAAA,kBAAA,CAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA;AAAA,QACA,MAAA,iCAAA,YAAA,OAAA,SAAA,QAAA;AAAA,MACA;AAAA,IACA,CAAA;AAGAC,kBAAAA,gBAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA;AAAA,MACA;AAAA,IACA,CAAA;AAGAC,kBAAAA,SAAA,MAAA;AACAN,0BAAA,kBAAA,kBAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClHA,GAAG,WAAW,eAAe;"}