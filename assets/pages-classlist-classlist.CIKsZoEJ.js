var e,t;import{o as s,c as a,w as l,e as n,F as i,f as o,q as u,y as r,r as d,i as y,b as c,z as p,s as m,A as h,d as f,a as v,B as g,m as k,j as _}from"./index-DAETP-ll.js";import{m as x,a as $}from"./mixin.ibwfZFPh.js";import{_ as C,b,c as j,o as w,a as A,d as E,r as T}from"./uni-app.es.DIcWXsBP.js";import{_ as B}from"./uni-load-more.CE5UZoVQ.js";import{f as F,g as z}from"./apis.B7QAMpyb.js";const L=C({name:"uv-skeletons",mixins:[x,$],props:{loading:{type:Boolean,default:!0},skeleton:{type:Array,default:()=>[]},animate:{type:Boolean,default:!0},round:{type:Boolean,default:!1},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.skeleton},data:()=>({elements:[],opacity:.5,duration:600}),computed:{animateClass(){return this.animate?"uv-skeleton--animation":"uv-skeleton--static"},roundClass(){return this.round?"uv-skeleton--round":"uv-skeleton--radius"},style(e){return e=>this.$uv.deepMerge({},this.$uv.addStyle(e.style))}},created(){this.init()},methods:{init(){let e=[];if(!this.$uv.test.array(this.skeleton))return this.$uv.error("skeleton参数必须为数组形式，参考文档示例：");this.skeleton.forEach(t=>{const s=this.getElCounts(t);e=e.concat(s)}),this.elements=[...e]},getElCounts(e){let t=[],s=[];if(this.$uv.test.number(e))return t.push({type:"gap",height:e}),t;{const a=e.type?e.type:"line",l=e.num?e.num:1,n=e.style?e.style:{},i=this.$uv.test.array(n),o=e.gap?e.gap:"20rpx",u=e.children?e.children:[];for(let e=0;e<u.length;e++)s[e]={clas:u[e].type.indexOf("avatar")>-1||u[e].type.indexOf("custom")>-1?"":"uv-skeleton__group__sub",elements:this.getElCounts(u[e])};for(let e=0;e<l;e++)o&&e<l&&e>0&&t.push({type:"gap",height:o}),t.push({clas:"uv-skeleton__"+a,type:a,style:i?n[e]:n,gap:o,children:s});return t}},createAnimation(e=1){if(!this.loading||!this.animate)return;let t=0;const s=this.$refs.skeleton;s.forEach(a=>{animation.transition(a,{styles:{opacity:e},duration:this.duration},()=>{t++,t>=s.length&&setTimeout(()=>{this.createAnimation(e<1?1:this.opacity)},200)})})}}},[["render",function(e,t,c,p,m,h){const f=y;return s(),a(f,{class:"uv-skeleton"},{default:l(()=>[c.loading?(s(),a(f,{key:0},{default:l(()=>[(s(!0),n(i,null,o(m.elements,(t,d)=>(s(),a(f,{key:d},{default:l(()=>["flex"==t.type?(s(),a(f,{key:0,class:"uv-skeleton__group",style:u([h.style(t)])},{default:l(()=>[(s(!0),n(i,null,o(t.children,(t,d)=>(s(),a(f,{class:r([t.clas]),style:u([h.style(t)]),key:d},{default:l(()=>[(s(!0),n(i,null,o(t.elements,(t,n)=>(s(),a(f,{key:n},{default:l(()=>["gap"==t.type?(s(),a(f,{key:0,style:u({height:e.$uv.addUnit(t.height,"rpx")})},null,8,["style"])):(s(),a(f,{key:1,class:r([t.clas,h.roundClass,h.animateClass]),style:u([h.style(t)]),ref_for:!0,ref:"skeleton"},null,8,["class","style"]))]),_:2},1024))),128))]),_:2},1032,["class","style"]))),128))]),_:2},1032,["style"])):"custom"==t.type?(s(),a(f,{key:1,class:r([t.clas,h.animateClass]),style:u([h.style(t)]),ref_for:!0,ref:"skeleton"},null,8,["class","style"])):"gap"==t.type?(s(),a(f,{key:2,style:u({height:e.$uv.addUnit(t.height,"rpx")})},null,8,["style"])):(s(),a(f,{key:3,class:r([t.clas,h.roundClass,h.animateClass]),style:u([h.style(t)]),ref_for:!0,ref:"skeleton"},null,8,["class","style"]))]),_:2},1024))),128))]),_:1})):(s(),a(f,{key:1},{default:l(()=>[d(e.$slots,"default",{},void 0,!0)]),_:3}))]),_:3})}],["__scopeId","data-v-cf4a5463"]]),S=C({__name:"classlist",setup(e){const t=c([]),u=c(!1),r=c({contentrefresh:"冲锋======================",contentnomore:"已经被榨干了TT"}),d=c(!0),x=c("more"),$=c([{type:"line",num:1,style:{width:"100%",height:"440rpx",borderRadius:"8rpx"}}]),C={pageNum:1,pageSize:12};let S;b(e=>{let{id:t=null,name:s=null,type:a=null}=e;a&&(C.type=a),t&&(C.classid=t),S=s,p({title:S}),I()}),j(()=>{u.value||"loading"!==x.value&&(C.pageNum++,I())});const I=async()=>{d.value||(x.value="loading");try{let e;C.classid&&(e=await F(C)),C.type&&(e=await z(C)),t.value=[...t.value,...e.data],m("storageClassList",t.value),C.pageSize>e.data.length?(u.value=!0,x.value="no-more"):x.value="more"}finally{d.value=!1}};return w(e=>({title:"翔翔壁纸",path:`/pages/classlist/classlist?id=${C.classid}&name=${S}`})),A(()=>({title:"翔翔壁纸"})),E(()=>{h("storageClassList")}),(e,u)=>{const c=T(f("uv-skeletons"),L),p=y,m=k,h=_,C=T(f("uni-load-more"),B);return s(),a(p,{class:"classList"},{default:l(()=>[v(p,{class:"content"},{default:l(()=>[d.value?(s(),n(i,{key:0},o(12,e=>v(p,{class:"item",key:e},{default:l(()=>[v(c,{loading:d.value,skeleton:$.value},null,8,["loading","skeleton"])]),_:2},1024)),64)):(s(!0),n(i,{key:1},o(t.value,e=>(s(),a(h,{url:"/pages/preview/preview?id="+e._id,class:"item",key:e._id},{default:l(()=>[v(m,{src:e.smallPicurl,mode:"aspectFill"},null,8,["src"])]),_:2},1032,["url"]))),128))]),_:1}),d.value?g("",!0):(s(),a(p,{key:0,class:"load-more-box"},{default:l(()=>[v(C,{status:x.value,color:"#007AFF",contentText:r.value},null,8,["status","contentText"])]),_:1}))]),_:1})}}},[["__scopeId","data-v-fe83d8d7"]]);export{S as default};
